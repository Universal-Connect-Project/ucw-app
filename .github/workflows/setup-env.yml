
name: Setup env file

on:
  workflow_call:
    outputs:
      ENV:
        description: 'Env file'
        value: ${{ jobs.env-file.outputs.ENV }}

jobs:
  env-file:
    name: 'Workflow: Load ENV Vars'
    runs-on: ubuntu-latest
    steps:
      - name: Loading repository variables to real env vars
        id: environment
        shell: bash
        env:
          ENV_INPUT: ${{ toJSON(secrets) }}
        run: |
          echo "-------"
          echo "$ENV_INPUT"
          echo "-------"
          echo "$ENV_INPUT" | jq -r 'keys[] as $k | "echo \"\($k)=\(.[$k] )\" >> $GITHUB_ENV"' > ./update_env.sh
          chmod +x ./update_env.sh
          ./update_env.sh

      - name: Output testing
        id: output
        shell: bash
        run: |
          echo ${{ env.DOCKER_USERNAME }}